id: http://w3id.org/ontogpt/phenopackets
name: phenopackets
title: Phenopackets Schema v2
description: >-
  A template for extracting a phenopacket, an anonymous
  phenotypic description of an individual or biosample
  with potential genes of interest and/or diagnoses.
  This template is based on the Phenopackets schema v2,
  originally defined in Protobuf. All classes are
  defined in a single schema here, with their corresponding
  module provided in a comment (e.g., core/individual).
  Some rendering also adapted from Chris Mungall's
  linkml-phenopackets
  (see https://github.com/cmungall/linkml-phenopackets).
  This does not include the VRS or VRSATILE schemas.
prefixes:
  ARGO: https://docs.icgc-argo.org/dictionary/
  EFO: http://www.ebi.ac.uk/efo/EFO_
  GENO: http://purl.obolibrary.org/obo/GENO_
  HP: http://purl.obolibrary.org/obo/HP_
  LOINC: https://loinc.org/
  MONDO: http://purl.obolibrary.org/obo/MONDO_
  NCIT: http://purl.obolibrary.org/obo/NCIT_
  UBERON: http://purl.obolibrary.org/obo/UBERON_
  UCUM: http://unitsofmeasure.org/
  UO: http://purl.obolibrary.org/obo/UO_
  linkml: https://w3id.org/linkml/
  phenopackets_schema: http://w3id.org/ontogpt/phenopackets
see_also:
  - https://github.com/phenopackets/phenopacket-schema
  - https://github.com/cmungall/linkml-phenopackets
keywords:
  - phenotype

default_prefix: phenopackets_schema
default_range: string

imports:
  - linkml:types
  - core

# NOTE: this is currently set up to extract details on
# a single patient at a time. Adapting to cohort-level
# extractions will require a container class and a
# mechanism for isolating specific patient details.

# TODO: identify which fields should not be generated
# (these are usually the identifiers, and we want be
# be sure they won't get generated by an LLM)

classes:
  Phenopacket:
    tree_root: true
    description: >-
      An anonymous phenotypic description of an individual or biosample with potential genes of interest and/or diagnoses.
      This is a bundle of high-level concepts with no specifically defined relational concepts. It is expected that the
      resources sharing the phenopackets will define and enforce their own semantics and level of requirements for included
      fields.
    attributes:
      id:
        description: An identifier specific for this phenopacket.
        range: string
        identifier: true
        annotations:
          prompt.skip: "true"
        comments:
          - This is not produced through generation
          - Must be assigned at write time
          - Example - PMID_10874631_II.2
      subject:
        description: >-
          The individual representing the focus of this packet - e.g. the proband in rare disease cases or cancer patient
        range: Individual
        annotations:
          prompt: >-
            The individual or biosample being described in the input text.
      phenotypic_features:
        description: >-
          Phenotypic features relating to the subject of the phenopacket
        range: PhenotypicFeature
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            A semicolon-separated list of phenotypic features observed in the
            individual or biosample.
      measurements:
        description: >-
          Quantifiable measurements related to the individual
        range: Measurement
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            A semicolon-separated list of measurements taken from the individual
            or biosample.
      biosample:
        description: >-
          Biosample(s) derived from the patient or a collection of biosamples in isolation
        range: Biosample
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            The biosample from which the phenopacket was derived.
      interpretations:
        description: >-
          Interpretations of the phenopacket
        range: Interpretation
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            A semicolon-separated list of interpretations of the input text.
      diseases:
        description: >-
          Field for disease identifiers - could be used for listing either diagnosed or suspected conditions. The
          resources using these fields should define what this represents in their context.
        range: Disease
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            A semicolon-separated list of diagnosed or suspected disease
            conditions.
      medical_actions:
        description: >-
          Field for medical action identifiers - could be used for listing either performed or planned actions. The
          resources using these fields should define what this represents in their context.
        range: MedicalAction
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            A semicolon-separated list of medical actions taken or planned.
      files:
        description: >-
          Pointer to the relevant file(s) for the individual
        range: File
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            A semicolon-separated list of file identifiers specified in the
            input text.
      meta_data:
        description: >-
          Structured definitions of the resources and ontologies used within the phenopacket. REQUIRED
        range: MetaData
        required: true
        annotations:
          prompt: >-
            Additional metadata for the phenopacket.

  Family:
    description: >-
      Phenotype, sample and pedigree data required for a genomic diagnosis.
      Equivalent to the Genomics England InterpretationRequestRD
      https://github.com/genomicsengland/GelReportModels/blob/master/schemas/IDLs/org.gel.models.report.avro/5.0.0/InterpretationRequestRD.avdl
    attributes:
      id:
        description: An identifier specific for this family.
        range: string
        identifier: true
        annotations:
          prompt.skip: "true"
        comments:
          - Must be assigned at write time
      proband:
        description: >-
          The individual representing the focus of this packet - e.g. the proband in rare disease cases or cancer patient
        range: Phenopacket
        annotations:
          prompt: >-
            The individual representing the focus of this input text,
            as a Phenopacket object.
      relatives:
        description: >-
          Individuals related in some way to the patient. For instance, the individuals may be genetically related or may
          be members of a cohort. If this field is used, then  it is expected that a pedigree will be included for
          genetically related individuals for use cases such as genomic diagnostics. If a phenopacket is being used to
          describe one member of a cohort, then in general one phenopacket will be created for each of the individuals in
          the cohort.
        range: Phenopacket
        multivalued: true
        annotations:
          prompt: >-
            A semicolon-separated list of relatives of the proband,
            as Phenopacket objects.
      consanguinous_parents:
        description: >-
          flag to indicate that the parents of the proband are consanguinous
        range: boolean
        annotations:
          prompt: >-
            Flag to indicate that the parents of the proband are consanguinous.
            This must be a boolean value - true or false.
            If unknown, do not include this field or a value for this field.
      pedigree:
        description: >-
          The pedigree defining the relations between the proband and their relatives. Pedigree.individual_id should
          map to the PhenoPacket.Individual.id
        range: Pedigree
        annotations:
          prompt: >-
            The pedigree defining the relations between the proband and their
            relatives.
      files:
        description: >-
          Pointer to the relevant file(s) for the family. These should be files relating to one or more of the family
          members e.g a multi-sample VCF. Files relating exclusively to individual phenopackets should be contained in the
          Phenopacket.
        range: File
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            A semicolon-separated list of file identifiers specified in the
            input text, relating to the family.
      meta_data:
        description: >-
          Structured definitions of the resources and ontologies used within the phenopacket. REQUIRED
        range: MetaData
        required: true
        annotations:
          prompt: >-
            Additional metadata for the phenopacket.

  Cohort:
    description: >-
      A group of individuals related in some phenotypic or genotypic aspect.
    attributes:
      id:
        description: An identifier specific for this cohort.
        range: string
        identifier: true
        annotations:
          prompt.skip: "true"
        comments:
          - Must be assigned at write time
      description:
        description: >-
          A description of the cohort, including the phenotypic or genotypic aspect that relates the individuals.
        range: string
        annotations:
          prompt: >-
            A description of the cohort, including the phenotypic or genotypic
            aspect that relates the individuals.
      members:
        description: >-
          Individuals in the cohort. Each individual should be described in a separate Phenopacket.
        range: Phenopacket
        multivalued: true
        annotations:
          prompt: >-
            A semicolon-separated list of individuals in the cohort,
            as Phenopacket objects.
      files:
        description: >-
          Pointer to relevant file(s) for the cohort. Files relating exclusively to individual phenopackets should be
          contained in the Phenopacket.
        range: File
        multivalued: true
        inlined: true
        annotations:
          prompt: >-
            A semicolon-separated list of file identifiers specified in the
            input text, relating to the cohort.
      meta_data:
        description: >-
          Structured definitions of the resources and ontologies used within the phenopacket. REQUIRED
        range: MetaData
        required: true
        annotations:
          prompt: >-
            Additional metadata for the phenopacket.

  # core/base

  OntologyClass:
    description: >-
      A class (aka term, concept) in an ontology.
      FHIR mapping: CodeableConcept (http://www.hl7.org/fhir/datatypes.html#CodeableConcept)
      see also Coding (http://www.hl7.org/fhir/datatypes.html#Coding)
    attributes:
      id:
        description: >-
          a CURIE-style identifier e.g. HP:0100024, MP:0001284, UBERON:0001690.
          This is the primary key for the ontology class
          REQUIRED!
        range: uriorcurie
        required: true
        identifier: true
        annotations:
          prompt.skip: "true"
        comments:
          - Assigned through grounding and normalization
      label:
        description: >-
          class label, aka name. E.g. "Abnormality of cardiovascular system"
        range: string
        annotations:
          prompt: >-
            The human-readable label of the class.

  ExternalReference:
    description: >-
      FHIR mapping: Reference (https://www.hl7.org/fhir/references.html)
    attributes:
      id:
        description: >-
          e.g. ISBN, PMID:123456, DOI:...,
          FHIR mapping: Reference.identifier
        range: uriorcurie
        identifier: true
        annotations:
          prompt.skip: "true"
        comments:
          - Must be assigned at write time
      reference:
        description: >-
          A full or partial URL pointing to the external reference if no commonly resolvable identifier can be used in the
          `id` field
          FHIR mapping Reference.reference
        range: string
        annotations:
          prompt: >-
            A full or partial URL pointing to the external reference.
      description:
        description: >-
          Human readable title or display string for the reference
          FHIR mapping: Reference.display
        range: string
        annotations:
          prompt: >-
            Human readable title or display string for the reference.

  Evidence:
    description: >-
      FHIR mapping: Condition.evidence
      https://www.hl7.org/fhir/condition-definitions.html#Condition.evidence
    attributes:
      evidence_code:
        description: >-
          The encoded evidence type using, for example the Evidence & Conclusion
          Ontology (ECO - http://purl.obolibrary.org/obo/eco.owl)
        range: OntologyClass
      reference:
        description: >-
          FHIR mapping: Condition.evidence.detail
        range: ExternalReference

  Procedure:
    description: >-
      A clinical procedure performed on a subject. By preference a single concept to indicate both the procedure and the
      body site should be used. In cases where this is not possible, the body site should be indicated using a separate
      ontology class.
      e.g.
      {"code":{"NCIT:C51585": "Biopsy of Soft Palate"}}
      {"code":{"NCIT:C28743": "Punch Biopsy"}, "body_site":{"UBERON:0003403": "skin of forearm"}} - a punch biopsy of the skin from the forearm
      FHIR mapping: Procedure (https://www.hl7.org/fhir/procedure.html)
    attributes:
      code:
        description: >-
          FHIR mapping: Procedure.code
        range: OntologyClass
        annotations:
          prompt: >-
            The code for the procedure.
      body_site:
        description: >-
          FHIR mapping: Procedure.bodySite
        range: OntologyClass
        annotations:
          prompt: >-
            The code for the body site of the procedure.
      performed:
        description: >-
          When the procedure was performed.
        range: TimeElement
        annotations:
          prompt: >-
            The date and time the procedure was performed.

  GestationalAge:
    description: >-
      The gestational age of the individual at the time of the procedure.
    attributes:
      weeks:
        description: >-
          The gestational age in weeks.
        range: integer
        annotations:
          prompt: >-
            The gestational age in weeks. This must be an integer.
            Do not provide units or any non-integer value.
      days:
        description: >-
          The gestational age in days.
        range: integer
        annotations:
          prompt: >-
            The gestational age in days. This must be an integer.
            Do not provide units or any non-integer value.

  # TODO: use an extant LinkML type for this
  Age:
    description: >-
      See http://build.fhir.org/datatypes and http://build.fhir.org/condition-definitions.html#Condition.onset_x_
      In FHIR this is represented as a UCUM measurement - http://unitsofmeasure.org/trac/
    attributes:
      iso8601duration:
        description: >-
          The :ref:`ISO 8601<metadata_date_time>` age of this object as ISO8601
          duration or time intervals. e.g. P40Y10M05D)
        range: string
        annotations:
          prompt: >-
            The age as an ISO 8601 duration.
            Do not provide units.
          prompt.example: P40Y10M05D

  AgeRange:
    description: >-
      A range of ages.
    attributes:
      start:
        description: >-
          The minimum age in the range.
        range: Age
        annotations:
          prompt: >-
            The minimum age in the range.
            This should be an integer.
      end:
        description: >-
          The maximum age in the range.
        range: Age
        annotations:
          prompt: >-
            The maximum age in the range.
            This should be an integer.

  # TODO: in the protobuf schema the slots are
  # typed as google.protobuf.Timestamp.
  # Find an equivalent - for now this is strings
  TimeInterval:
    description: >-
      A time interval.
    attributes:
      start:
        description: >-
          The start of the time interval.
        range: string
        annotations:
          prompt: >-
            The start of the time interval.
      end:
        description: >-
          The end of the time interval.
        range: string
        annotations:
          prompt: >-
            The end of the time interval.

  # TODO: this contains a oneof in the protobuf schema
  # so that cardinality may be represented here:
  # only one of the following fields may be present
  TimeElement:
    description: >-
      A time element.
    attributes:
      gestational_age:
        range: GestationalAge
      age:
        range: Age
      age_range:
        range: AgeRange
      ontology_class:
        range: OntologyClass
      timestamp:
        # originally google.protobuf.Timestamp
        range: string
      interval:
        range: TimeInterval

  # TODO: represent mappings here
  # for now they are strings
  File:
    description: >-
      A file or set of files.
    attributes:
      uri:
        description: >-
          URI for the file e.g. file://data/genomes/file1.vcf.gz or https://opensnp.org/data/60.23andme-exome-vcf.231?1341012444
        range: string
        annotations:
          prompt: >-
            A unique resource identifier for the file.
            This may be a file path (beginning with file://) or URL.
          prompt.example: file://data/genomes/file1.vcf.gz
      individual_to_file_identifiers:
        description: >-
          A map of identifiers mapping an individual to a sample in the file. The key values must correspond to the
          Individual::id for the individuals in the message, the values must map to the samples in the file.
        range: string
        annotations:
          prompt: >-
            A map of identifiers mapping an individual to a sample in the file.
            The key values must correspond to the Individual::id for the individuals.
      file_attributes:
        description: >-
          Map of attributes describing the file. For example the File format or genome assembly would be defied here. For
          genomic data files there MUST be a 'genomeAssembly' key.
        range: string
        annotations:
          prompt: >-
            Map of attributes describing the file.

  # core/biosample

  Biosample:
    description: >-
      A Biosample refers to a unit of biological material from which the
      substrate molecules (e.g. genomic DNA, RNA, proteins) for molecular
      analyses (e.g. sequencing, array hybridisation, mass-spectrometry) are
      extracted. Examples would be a tissue biopsy, a single cell from a
      culture for single cell genome sequencing or a protein fraction from a
      gradient centrifugation. Several instances (e.g. technical replicates) or
      types of experiments (e.g. genomic array as well as RNA-seq experiments)
      may refer to the same Biosample. FHIR mapping: Specimen
      (http://www.hl7.org/fhir/specimen.html)."
    attributes:
      derivedFromId:
        description: >-
          The id of the parent biosample this biosample was derived from.
        range: string
        annotations:
          prompt: >-
            A unique identifier for the parent biosample of this biosample.
      description:
        description: >-
          The biosample's description. This attribute contains human readable
          text. The "description" attributes should not contain any structured
          data.
        range: string
        annotations:
          prompt: >-
            Description of the biosample.
      diagnosticMarkers:
        description: >-
          Clinically relevant bio markers. Most of the assays such as IHC are
          covered by the NCIT under the sub-hierarchy NCIT:C25294 (Laboratory
          Procedure). e.g. NCIT:C68748 (HER2/Neu Positive), NCIT:C131711
          (Human Papillomavirus-18 Positive)
        range: OntologyClass
        annotations:
          prompt: >-
            Description of clinically relevant bio markers.
          prompt.example: NCIT:C68748 (HER2/Neu Positive)
        inlined_as_list: true
        multivalued: true
      files:
        description: >-
          Pointer to the relevant file(s) for the biosample. Files relating to
          the entire individual e.g. a germline exome/genome should be
          associated with the Phenopacket rather than the Biosample it was
          derived from.
        range: File
        inlined_as_list: true
        multivalued: true
      histologicalDiagnosis:
        description: >-
          This is the pathologist’s diagnosis and may often represent a
          refinement of the clinical diagnosis given in the Patient/Clinical
          module. Should use the same terminology as diagnosis, but represent
          the pathologist’s findings. Normal samples would be tagged with the
          term "NCIT:C38757", "Negative Finding" ARGO mapping
          specimen::tumour_histological_type
        exact_mappings:
          - ARGO:specimen.tumour_histological_type
        inlined: true
        range: OntologyClass
      id:
        annotations:
          percent_encoded: true
        description: >-
          biosamples SAMN08666232 Human Cell Atlas The Biosample id
          This is unique in the context of the server instance.
          ARGO mapping specimen::submitter_specimen_id
        exact_mappings:
          - ARGO:specimen.submitter_specimen_id
        range: string
      individualId:
        description: >-
          The id of the individual this biosample was derived from. ARGO
          mapping specimen::submitter_donor_id
        exact_mappings:
          - ARGO:specimen.submitter_donor_id
        range: string
      materialSample:
        description: >-
          This element can be used to specify the status of the sample. For
          instance, a status may be used as a normal control, often in
          combination with another sample that is thought to contain a
          pathological finding. We recommend use of ontology terms such as:
          EFO:0009654 (reference sample) or EFO:0009655 (abnormal sample)
          ARGO mapping sample_registration::tumour_normal_designation
        exact_mappings:
          - ARGO:sample_registration.tumour_normal_designation
        inlined: true
        range: OntologyClass
      measurements:
        description: ""
        inlined_as_list: true
        multivalued: true
        range: Measurement
      pathologicalStage:
        description: >-
          ARGO mapping specimen::pathological_tumour_staging_system ARGO
          mapping specimen::pathological_stage_group
        exact_mappings:
          - ARGO:specimen.pathological_tumour_staging_system
        inlined: true
        range: OntologyClass
      pathologicalTnmFinding:
        description: >-
          ARGO mapping specimen::pathological_t_category ARGO mapping
          specimen::pathological_n_category ARGO mapping
          specimen::pathological_m_category
        exact_mappings:
          - ARGO:specimen.pathological_t_category
        inlined_as_list: true
        multivalued: true
        range: OntologyClass
      phenotypicFeatures:
        description: >-
          Phenotypic characteristics of the BioSample, for example histological
          findings of a biopsy.
        inlined_as_list: true
        multivalued: true
        range: PhenotypicFeature
      procedure:
        description: >-
          Clinical procedure performed on the subject in order to extract the
          biosample. ARGO mapping specimen::specimen_anatomic_location -
          Procedure::body_site ARGO mapping
          specimen::specimen_acquisition_interval - Procedure::time_performed
        exact_mappings:
          - ARGO:specimen.specimen_anatomic_location
        range: Procedure
      sampleProcessing:
        description: >-
          Field to represent how the sample was processed. ARGO mapping
          specimen::specimen_processing
        exact_mappings:
          - ARGO:specimen.specimen_processing
        inlined: true
        range: OntologyClass
      sampleStorage:
        description: >-
          Field to represent how the sample was stored ARGO mapping
          specimen::specimen_storage
        exact_mappings:
          - ARGO:specimen.specimen_storage
        inlined: true
        range: OntologyClass
      sampleType:
        description: >-
          Recommended use of EFO term to describe the sample. e.g.
          Amplified DNA, ctDNA, Total RNA, Lung tissue, Cultured cells...
          ARGO mapping sample_registration::sample_type
        exact_mappings:
          - ARGO:sample_registration.sample_type
        inlined: true
        range: OntologyClass
      sampledTissue:
        description: >-
          UBERON class describing the tissue from which the specimen was
          collected. PDX-MI mapping: 'Specimen tumor tissue' FHIR mapping:
          Specimen.type ARGO mapping
          sample_registration::specimen_tissue_source"
        exact_mappings:
          - ARGO:sample_registration.specimen_tissue_source
        inlined: true
        range: OntologyClass
      taxonomy:
        description: >-
          NCBI taxonomic identifier (NCBITaxon) of the sample e.g.
          NCBITaxon:9606
        inlined: true
        range: OntologyClass
      timeOfCollection:
        description: >-
          An TimeElement describing either the age of the individual this
          biosample was derived from at the time of collection, or the time
          itself. See http://build.fhir.org/datatypes
        inlined: true
        range: TimeElement
      tumorGrade:
        description: >-
          Potentially a child term of NCIT:C28076 (Disease Grade Qualifier) or
          equivalent See
          https://www.cancer.gov/about-cancer/diagnosis-staging/prognosis/tumor-grade-fact-sheet
        inlined: true
        range: OntologyClass
      tumorProgression:
        description: >-
          Is the specimen tissue from the primary tumor, a metastasis or a
          recurrence? Most likely a child term of NCIT:C7062 (Neoplasm by
          Special Category) NCIT:C3677 (Benign Neoplasm) NCIT:C84509 (Primary
          Malignant Neoplasm) NCIT:C95606 (Second Primary Malignant Neoplasm)
          NCIT:C3261 (Metastatic Neoplasm) NCIT:C4813 (Recurrent Malignant
          Neoplasm)
        inlined: true
        range: OntologyClass

  # core/disease

  Disease:
    description: >-
      Message to indicate a disease (diagnosis) and its recorded onset.
    attributes:
      clinicalTnmFinding:
        description: >-
          Cancer findings in the TNM system that is relevant to the diagnosis
          of cancer. See
          https://www.cancer.gov/about-cancer/diagnosis-staging/staging
          Valid values include child terms of NCIT:C48232 (Cancer TNM Finding)
          ARGO mapping primary_diagnosis::clinical_t_category ARGO mapping
          primary_diagnosis::clinical_n_category ARGO mapping
          primary_diagnosis::clinical_m_category
        exact_mappings:
          - ARGO:primary_diagnosis.clinical_t_category
        inlined_as_list: true
        multivalued: true
        range: OntologyClass
      diseaseStage:
        description: >-
          Disease staging, the extent to which a disease has developed. For
          cancers, see
          https://www.cancer.gov/about-cancer/diagnosis-staging/staging
          Valid values include child terms of NCIT:C28108 (Disease Stage
          Qualifier) ARGO mapping
          primary_diagnosis::clinical_tumour_staging_system ARGO mapping
          primary_diagnosis::clinical_stage_group
        exact_mappings:
          - ARGO:primary_diagnosis.clinical_tumour_staging_system
        inlined_as_list: true
        multivalued: true
        range: OntologyClass
      excluded:
        description: >-
          Flag to indicate whether the disease was observed or not. Default is
          'false', in other words the disease was observed. Therefore it is
          only required in cases to indicate that the disease was looked for,
          but found to be absent. More formally, this modifier indicates the
          logical negation of the OntologyClass used in the 'term' field.
          *CAUTION* It is imperative to check this field for correct
          interpretation of the disease!
        range: boolean
      laterality:
        description: >-
          The term used to indicate laterality of diagnosis, if applicable.
          (Codelist reference: NCI CDE: 4122391)
        inlined: true
        range: OntologyClass
      onset:
        description: >-
          The onset of the disease. The values of this will come from the HPO
          onset hierarchy i.e. subclasses of HP:0003674 FHIR mapping:
            Condition.onset ARGO mapping primary_diagnosis::age_at_diagnosis
        exact_mappings:
          - ARGO:primary_diagnosis.age_at_diagnosis
        inlined: true
        range: TimeElement
      primarySite:
        description: >-
          The text term used to describe the primary site of disease, as
          categorized by the World Health Organization's (WHO) International
          Classification of Diseases for Oncology (ICD-O). This categorization
          groups cases into general
        inlined: true
        range: OntologyClass
      resolution:
        description: ""
        inlined: true
        range: TimeElement
      term:
        description: >-
          The identifier of this disease e.g. MONDO:0007043, OMIM:101600,
          Orphanet:710, DOID:14705 (note these are all equivalent) ARGO mapping
          primary_diagnosis::submitter_primary_diagnosis_id
        exact_mappings:
          - ARGO:primary_diagnosis.submitter_primary_diagnosis_id
        inlined: true
        range: OntologyClass

  # core/interpretation

  Diagnosis:
    description: ""
    attributes:
      disease:
        description: >-
          The disease/condition assigned to the diagnosis.
          Details about this disease may be contained in the `diseases` field
          in the Phenopacket.
        inlined: true
        range: OntologyClass
      genomicInterpretations:
        description: >-
          genomic features containing the status of their contribution towards
          the diagnosis
        inlined_as_list: true
        multivalued: true
        range: GenomicInterpretation

  GenomicInterpretation:
    description: >-
      A statement about the contribution of a genomic element towards the
      observed phenotype. Note that this does not intend to encode any
      knowledge or results of specific computations.
    attributes:
      gene:
        description: ""
        inlined: true
        range: GeneDescriptor
      interpretationStatus:
        description: ""
        range: InterpretationStatus
      subjectOrBiosampleId:
        description: >-
          identifier for the subject of the interpretation. This MUST be the
          individual id or a biosample id of the enclosing phenopacket.
        range: string
      variantInterpretation:
        description: ""
        range: VariantInterpretation
    rules:
      - postconditions:
          exactly_one_of:
            - slot_conditions:
                gene:
                  required: true
            - slot_conditions:
                variantInterpretation:
                  required: true

  Interpretation:
    description: ""
    attributes:
      diagnosis:
        description: The diagnosis made in this interpretation
        range: Diagnosis
      id:
        description: id of the interpretation
        range: string
        identifier: true
        annotations:
          prompt.skip: "true"
          percent_encoded: true
        comments:
          - Must be assigned at write time
      progressStatus:
        description: ""
        range: ProgressStatus
      summary:
        description: ""
        range: string

  VariantInterpretation:
    description: ""
    attributes:
      acmgPathogenicityClassification:
        description: ""
        range: AcmgPathogenicityClassification
      therapeuticActionability:
        description: ""
        range: TherapeuticActionability
      variationDescriptor:
        description: ""
        range: VariationDescriptor

  # core/individual

  Individual:
    description: >-
      An individual (or subject) typically corresponds to an individual human
      or another organism. FHIR mapping: Patient
      (https://www.hl7.org/fhir/patient.html)."
    attributes:
      alternateIds:
        description: >-
          An optional list of alternative identifiers for this individual. This
          field is provided for the convenience of users who may have multiple
          mappings to an individual which they need to track.
        multivalued: true
        range: string
      dateOfBirth:
        description: >-
          The date of birth of the individual as an ISO8601 UTC timestamp -
          rounded down to the closest known year/month/day/hour/minute e.g.
          "2018-03-01T00:00:00Z" for someone born on an unknown day in March
          2018 or "2018-01-01T00:00:00Z" for someone born on an unknown day in
          2018 or empty if unknown/ not stated.
        range: string
      gender:
        description: Self-identified gender
        inlined: true
        range: OntologyClass
      id:
        description: >-
          An identifier for the individual. This must be unique within the
          record. ARGO mapping donor::submitter_donor_id
        exact_mappings:
          - ARGO:donor.submitter_donor_id
        range: string
        identifier: true
        annotations:
          prompt.skip: "true"
          percent_encoded: true
        comments:
          - Must be assigned at write time
      karyotypicSex:
        description: The karyotypic sex of the individual
        range: KaryotypicSex
      sex:
        description: >-
          The phenotypic sex of the individual ARGO mapping
          sample_registration::gender (this is complicated as ARGO only have
          male/female/other which maps to the phenopacket Sex field)
        exact_mappings:
          - ARGO:sample_registration.gender
        range: Sex
      taxonomy:
        description: >-
          NCBI taxonomic identifier NCBITaxon e.g. NCBITaxon:9606 or
          NCBITaxon:1337 For resources where there may be more than one
          organism being studied it is advisable to indicate the taxonomic
          identifier of that organism, to its most specific level
        inlined: true
        range: OntologyClass
      timeAtLastEncounter:
        description: >-
          An TimeElement object describing the age of the individual at the
          last time of collection. The Age object allows the encoding of the
          age either as ISO8601 duration or time interval (preferred), or as
          ontology term object. See http://build.fhir.org/datatypes
        inlined: true
        range: TimeElement
      vitalStatus:
        description: >-
          Vital status of the individual. If not present it is assumed that the
          individual is alive. If present it will default to 'false' i.e. the
          individual was alive when the data was collected.
          ARGO mapping donor::vital_status
        exact_mappings:
          - ARGO:donor.vital_status
        range: VitalStatus

  VitalStatus:
    description: ""
    attributes:
      causeOfDeath:
        description: ARGO mapping donor::cause_of_death
        exact_mappings:
          - ARGO:donor.cause_of_death
        inlined: true
        range: OntologyClass
      status:
        description: ""
        range: Status
      survivalTimeInDays:
        description: ARGO mapping donor::survival_time
        exact_mappings:
          - ARGO:donor.survival_time
        range: integer
      timeOfDeath:
        description: ""
        inlined: true
        range: TimeElement

  # core/measurement

  ComplexValue:
    description: ""
    attributes:
      typedQuantities:
        description: >-
          The quantities required to fully describe the complex value. For
          example the systolic and diastolic blood pressure quantities
        inlined_as_list: true
        multivalued: true
        range: TypedQuantity

  Measurement:
    description: >-
      FHIR mapping: Observation (https://www.hl7.org/fhir/observation.html)
    attributes:
      assay:
        description: >-
          An ontology class which describes the assay used to produce the
          measurement. For example "body temperature" (CMO:0000015) or
          "Platelets [#/volume] in Blood" (LOINC:26515-7) FHIR mapping:
          Observation.code'
        inlined: true
        range: OntologyClass
      complexValue:
        description: ""
        range: ComplexValue
      description:
        description: >-
          Free-text description of the feature. Note this is not a acceptable
          place to document/describe the phenotype - the type and onset etc...
          fields should be used for this purpose.
        range: string
      procedure:
        description: >-
          Clinical procedure performed on the subject in order to produce the
          measurement.
        range: Procedure
      timeObserved:
        description: The time at which the measurement was made
        inlined: true
        range: TimeElement
      value:
        description: ""
        range: Value
    rules:
      - postconditions:
          exactly_one_of:
            - slot_conditions:
                value:
                  required: true
            - slot_conditions:
                complexValue:
                  required: true

  Quantity:
    description: ""
    attributes:
      referenceRange:
        description: >-
          Reference range for the quantity e.g. The normal range of platelets
          is 150,000 to 450,000 platelets/uL.
        range: ReferenceRange
      unit:
        description: >-
          For instance, NCIT subhierarchy, Unit of Measure (Code C25709),
          https://www.ebi.ac.uk/ols/ontologies/uo
        inlined: true
        range: OntologyClass
      value:
        description: the value of the quantity in the units e.g. 2.0 mg
        range: double

  ReferenceRange:
    description: ""
    attributes:
      high:
        description: ""
        range: double
      low:
        description: ""
        range: double
      unit:
        description: ""
        inlined: true
        range: OntologyClass

  TypedQuantity:
    description: >-
      For complex measurements, such as blood pressure where more than one
      component quantity is required to describe the measurement
    attributes:
      quantity:
        description: e.g. mm Hg
        range: Quantity
      type:
        description: e.g. diastolic, systolic
        inlined: true
        range: OntologyClass

  Value:
    description: ""
    attributes:
      ontologyClass:
        description: >-
          for use with things such as categories 'red', 'yellow' or
          'absent'/'present'
        inlined: true
        range: OntologyClass
      quantity:
        description: ""
        range: Quantity
    rules:
      - postconditions:
          exactly_one_of:
            - slot_conditions:
                quantity:
                  required: true
            - slot_conditions:
                ontologyClass:
                  required: true

  # core/medical_action

  DoseInterval:
    description: e.g. 50mg/ml 3 times daily for two weeks
    attributes:
      interval:
        description: ""
        inlined: true
        range: TimeInterval
      quantity:
        description: ""
        range: Quantity
      scheduleFrequency:
        description: ""
        inlined: true
        range: OntologyClass

  MedicalAction:
    description: >-
      medication, procedure, other actions taken for clinical management
    attributes:
      adverseEvents:
        description: ARGO mapping treatment::adverse_events
        exact_mappings:
          - ARGO:treatment.adverse_events
        inlined_as_list: true
        multivalued: true
        range: OntologyClass
      procedure:
        description: ""
        range: Procedure
      radiationTherapy:
        description: ""
        range: RadiationTherapy
      responseToTreatment:
        description: ARGO mapping treatment::response_to_treatment
        exact_mappings:
          - ARGO:treatment.response_to_treatment
        inlined: true
        range: OntologyClass
      therapeuticRegimen:
        description: ""
        range: TherapeuticRegimen
      treatment:
        description: ""
        range: Treatment
      treatmentIntent:
        description: >-
          Whether the intention of the treatment was curative, palliative,
          ARGO mapping treatment::treatment_intent
        exact_mappings:
          - ARGO:treatment.treatment_intent
        inlined: true
        range: OntologyClass
      treatmentTarget:
        description: >-
          The condition or disease that this treatment was intended to address.
          FHIR mapping Procedure::reasonCode
        inlined: true
        range: OntologyClass
      treatmentTerminationReason:
        description: ARGO mapping treatment::treatment_outcome
        exact_mappings:
          - ARGO:treatment.treatment_outcome
        inlined: true
        range: OntologyClass
    rules:
      - postconditions:
          exactly_one_of:
            - slot_conditions:
                procedure:
                  required: true
            - slot_conditions:
                treatment:
                  required: true
            - slot_conditions:
                radiationTherapy:
                  required: true
            - slot_conditions:
                therapeuticRegimen:
                  required: true

  RadiationTherapy:
    description: RadiationTherapy
    attributes:
      bodySite:
        description: >-
          The anatomical site where radiation therapy was administered.
          REQUIRED. ARGO mapping radiation::anatomical_site_irradiated
        exact_mappings:
          - ARGO:radiation.anatomical_site_irradiated
        inlined: true
        range: OntologyClass
        required: true
      dosage:
        description: >-
          The total dose given in units of Gray (Gy).
          REQUIRED. ARGO mapping radiation::radiation_therapy_dosage
        exact_mappings:
          - ARGO:radiation.radiation_therapy_dosage
        range: integer
        required: true
      fractions:
        description: >-
          The total number of fractions delivered as part of treatment.
          REQUIRED. ARGO mapping radiation::radiation_therapy_fractions
        exact_mappings:
          - ARGO:radiation.radiation_therapy_fractions
        range: integer
        required: true
      modality:
        description: >-
          The modality of radiation therapy (e.g., electron, photon,…).
          REQUIRED. ARGO mapping radiation::radiation_therapy_modality
        exact_mappings:
          - ARGO:radiation.radiation_therapy_modality
        inlined: true
        range: OntologyClass
        required: true

  TherapeuticRegimen:
    description: ARGO mapping radiation::radiation_therapy_type (missing)
    attributes:
      endTime:
        description: end time can be empty which would indicate ongoing
        inlined: true
        range: TimeElement
      externalReference:
        description: ""
        inlined: true
        range: ExternalReference
      ontologyClass:
        description: ""
        inlined: true
        range: OntologyClass
      regimenStatus:
        description: ""
        range: RegimenStatus
      startTime:
        description: possibly undefined;
        inlined: true
        range: TimeElement
    rules:
      - postconditions:
          exactly_one_of:
            - slot_conditions:
                externalReference:
                  required: true
            - slot_conditions:
                ontologyClass:
                  required: true

  Treatment:
    description: >-
      ARGO mapping treatment::is_primary_treatment (missing) treatment with an
      agent, such as a drug
    attributes:
      agent:
        description: ""
        inlined: true
        range: OntologyClass
      cumulativeDose:
        description: ARGO mapping chemotherapy::cumulative_drug_dosage
        exact_mappings:
          - ARGO:chemotherapy.cumulative_drug_dosage
        range: Quantity
      doseIntervals:
        description: ""
        inlined_as_list: true
        multivalued: true
        range: DoseInterval
      drugType:
        description: ""
        range: DrugType
      routeOfAdministration:
        description: ""
        inlined: true
        range: OntologyClass

  # core/meta_data

  MetaData:
    description: ""
    attributes:
      created:
        description: >-
          ISO8601 UTC timestamp for when this phenopacket was created in ISO
          "2018-03-01T00:00:00Z"
        range: string
      createdBy:
        description: >-
          some kind of identifier for the contributor/ program ARGO
          sample_registration::program_id
        range: string
      externalReferences:
        description: >-
          External identifiers for this message. These are considered different
          representation of the same record, not records which are in some
          other relation with the record at hand. For example this might be a
          PubMed reference to a study in which the individuals are reported.
        inlined_as_list: true
        multivalued: true
        range: ExternalReference
      phenopacketSchemaVersion:
        description: phenopacket-schema-version used to create this phenopacket
        range: string
      resources:
        description: >-
          a listing of the ontologies and resources referenced in the
          phenopacket
        inlined_as_list: true
        multivalued: true
        range: Resource
      submittedBy:
        description: >-
          information about the person/organisation/network that has submitted
          this phenopacket
        range: string
      updates:
        description: An OPTIONAL list of Updates to the phenopacket.
        inlined_as_list: true
        multivalued: true
        range: Update

  Resource:
    description: >-
      Description of an external resource used for referencing an object.
      For example the resource may be an ontology such as the HPO or SNOMED.
      FHIR mapping: CodeSystem (http://www.hl7.org/fhir/codesystem.html)
    attributes:
      id:
        annotations:
          percent_encoded: true
        description: >-
          for OBO Ontologies, the value of this string MUST always be the
          official OBO ID, which is always equivalent to the ID prefix in lower
          case. Examples: hp, go, mp, mondo Consult http://obofoundry.org for a
          complete list For other ontologies (e.g. SNOMED), use the prefix in
          identifiers.org"
        range: string
      iriPrefix:
        description: >-
          Full IRI prefix which can be used with the namespace_prefix and the
          OntologyClass::id to resolve to an IRI for a term. Tools such as the
          curie-util (https://github.com/prefixcommons/curie-util) can utilise
          this to produce fully-resolvable IRIs for an OntologyClass. e.g.
          Using the HPO term encoding the concept of 'Severe' OntologyClass:
          id: 'HP:0012828' label: 'Severe' Resource: namespace_prefix: 'HP'
          iri_prefix: 'http://purl.obolibrary.org/obo/HP_' the term can be
          resolved to http://purl.obolibrary.org/obo/HP_0012828"
        range: string
      name:
        description: >-
          e.g. The Human Phenotype Ontology for OBO Ontologies, the value of
          this string SHOULD be the same as the title field on
          http://obofoundry.org however, this field is purely for information
          purposes and software should not encode any assumptions
        range: string
      namespacePrefix:
        description: >-
          The prefix used in the CURIE of an OntologyClass e.g. HP, MP, ECO
          For example an HPO term will have a CURIE like this - HP:0012828
          which should be used in combination with the iri_prefix to form a
          fully-resolvable IRI
        range: string
      url:
        description: >-
          For OBO ontologies, this should always be the PURL, e.g.
          http://purl.obolibrary.org/obo/hp.owl,
          http://purl.obolibrary.org/obo/hp.obo
        range: string
      version:
        description: for OBO ontologies, this should be the versionIRI
        range: string

  Update:
    description: >-
      Information about when an update to a record occurred, who or what made
      the update and any pertinent information regarding the content and/or
      reason for the update
    attributes:
      comment:
        description: >-
          Textual comment about the changes made to the content and/or reason
          for the update. OPTIONAL
        range: string
      timestamp:
        description: >-
          ISO8601 UTC timestamps at which this record was updated, in the
          format YYYY-MM-DDTHH:MM:SS.SSSZ e.g. 2007-12-03T10:15:30.00Z REQUIRED
        range: string
        required: true
      updatedBy:
        description: >-
          Information about the person/organisation/network that has updated
          the phenopacket. OPTIONAL
        range: string

  # core/pedigree

  Pedigree:
    description: https://software.broadinstitute.org/gatk/documentation/article?id=11016
    attributes:
      persons:
        description: ""
        inlined_as_list: true
        multivalued: true
        range: Person

  Person:
    description: ""
    attributes:
      affectedStatus:
        description: ""
        range: AffectedStatus
      familyId:
        description: ""
        range: string
      individualId:
        description: ""
        range: string
      maternalId:
        description: ""
        range: string
      paternalId:
        description: ""
        range: string
      sex:
        description: ""
        range: Sex

  # core/phenotypic_feature

  PhenotypicFeature:
    description: >-
      An individual phenotypic feature, observed as either present or absent
      (negated), with possible onset, modifiers and frequency FHIR mapping:
      Condition (https://www.hl7.org/fhir/condition.html) or Observation
      (https://www.hl7.org/fhir/observation.html)
    attributes:
      description:
        description: >-
          Free-text description of the phenotype. Note this is not a acceptable
          place to document/describe the phenotype - the type and onset etc...
          fields should be used for this purpose.
        range: string
      evidence:
        description: Evidences for how the phenotype was determined.
        multivalued: true
        range: Evidence
      excluded:
        description: >-
          Flag to indicate whether the phenotype was observed or not. Default
          is 'false', in other words the phenotype was observed. Therefore it
          is only required in cases to indicate that the phenotype was looked
          for, but found to be absent. More formally, this modifier indicates
          the logical negation of the OntologyClass used in the 'type' field.
          *CAUTION* It is imperative to check this field for correct
          interpretation of the phenotype!
        range: boolean
      modifiers:
        description: >-
          subclasses of HP:0012823 ! Clinical modifier apart from Severity
          HP:0012824 - Severity
        inlined_as_list: true
        multivalued: true
        range: OntologyClass
      onset:
        description: >-
          the values of this will come from the HPO onset hierarchy i.e.
          subclasses of HP:0003674 FHIR mapping: Condition.onset
        inlined: true
        range: TimeElement
      resolution:
        description: ""
        inlined: true
        range: TimeElement
      severity:
        description: >-
          Severity of the condition e.g. subclasses of HP:0012824-Severity or
          SNOMED:272141005-Severities FHIR mapping: Condition.severity
        inlined: true
        range: OntologyClass
      type:
        description: >-
          The primary ontology class which describes the phenotype. For example
          "HP:0001363"  "Craniosynostosis" FHIR mapping: Condition.identifier'
        inlined: true
        range: OntologyClass

# TODO: enums need to be described in prompts
enums:
  # core/interpretation

  AcmgPathogenicityClassification:
    description: ""
    permissible_values:
      BENIGN:
        description: ""
      LIKELY_BENIGN:
        description: ""
      LIKELY_PATHOGENIC:
        description: ""
      NOT_PROVIDED:
        description: ""
      PATHOGENIC:
        description: ""
      UNCERTAIN_SIGNIFICANCE:
        description: ""
  InterpretationStatus:
    description: ""
    permissible_values:
      CANDIDATE:
        description: ""
      CAUSATIVE:
        description: ""
      CONTRIBUTORY:
        description: ""
      REJECTED:
        description: ""
      UNKNOWN_STATUS:
        description: ""
  ProgressStatus:
    description: ""
    permissible_values:
      COMPLETED:
        description: ""
      IN_PROGRESS:
        description: ""
      SOLVED:
        description: ""
      UNKNOWN_PROGRESS:
        description: ""
      UNSOLVED:
        description: ""
  TherapeuticActionability:
    description: ""
    permissible_values:
      ACTIONABLE:
        description: ""
      NOT_ACTIONABLE:
        description: ""
      UNKNOWN_ACTIONABILITY:
        description: ""

  # core/individual

  KaryotypicSex:
    description: Karyotypic sex of the individual
    permissible_values:
      OTHER_KARYOTYPE:
        description: ""
      UNKNOWN_KARYOTYPE:
        description: ""
      XO:
        description: ""
      XX:
        description: ""
      XXX:
        description: ""
      XXXX:
        description: ""
      XXXY:
        description: ""
      XXY:
        description: ""
      XXYY:
        description: ""
      XY:
        description: ""
      XYY:
        description: ""
  Sex:
    description: >-
      Sex of an individual FHIR mapping: AdministrativeGender
      (https://www.hl7.org/fhir/codesystem-administrative-gender.html)
    permissible_values:
      FEMALE:
        description: Female
      MALE:
        description: Male
      OTHER_SEX:
        description: >-
          It is not possible, to accurately assess the applicability of
          MALE/FEMALE.
      UNKNOWN_SEX:
        description: Not assessed / available.
  Status:
    description: Default = false i.e. the individual is alive. MUST be true if
    permissible_values:
      ALIVE:
        description: ""
      DECEASED:
        description: ""
      UNKNOWN_STATUS:
        description: ""

  # core/medical_action

  DrugType:
    description: A simplified version of ODHSI-DRUG_EXPOSURE
    permissible_values:
      ADMINISTRATION_RELATED_TO_PROCEDURE:
        description: ""
      EHR_MEDICATION_LIST:
        description: ""
      PRESCRIPTION:
        description: ""
      UNKNOWN_DRUG_TYPE:
        description: ""
  RegimenStatus:
    description: ""
    permissible_values:
      COMPLETED:
        description: ""
      DISCONTINUED:
        description: ""
      STARTED:
        description: ""
      UNKNOWN_STATUS:
        description: ""

  # core/pedigree

  AffectedStatus:
    description: ""
    permissible_values:
      AFFECTED:
        description: ""
      MISSING:
        description: ""
      UNAFFECTED:
        description: ""
